TRIPTYCH.MP2LayoutEngine=function(a){};TRIPTYCH.MP2LayoutEngine.prototype=new TRIPTYCH.ForceDirectedLayoutEngine();TRIPTYCH.MP2LayoutEngine.prototype.constructor=TRIPTYCH.MP2LayoutEngine;TRIPTYCH.MP2LayoutEngine.prototype.randomNodePositions=function(){var b=this.graph.nodes;var a=b.length;for(var c=0;c<a;c++){var d=b[c];d.position.set(Math.random()*2-1,Math.random()*2-1,0);d.position.normalize();d.position.multiplyScalar(Math.random()*10+200)}};TRIPTYCH.MP2LayoutEngine.prototype.addForce=function(c,a,b){if(c.force&&a){c.force.x=c.force.x+a.x*b;c.force.y=c.force.y+a.y*b;c.force.z=0}else{console.log("undefined force or vector")}};TRIPTYCH.MP2LayoutEngine.prototype.addRepulsiveForces=function(c,a){if(this.nodesSharePlane(c,a)){var b=c.getVector(a);b.z=0;var e=b.length()/this.edgeLength;if(e<0.1){e=0.1}var d=this.repulsion/(e*e);this.addForce(c,b,-1*d);this.addForce(a,b,d)}};TRIPTYCH.MP2LayoutEngine.prototype.nodesSharePlane=function(b,a){if(b.planes&&a.planes){for(var c=0;c<b.planes.length;c++){var d=b.planes[c];if(a.planes.lastIndexOf(d)!=-1){return true}}return false}return true};TRIPTYCH.MP2LayoutEngine.prototype.addEdgeForces=function(f){var g=f.from;var e=f.to;var d=g.getVector(e);d.z=0;var a=f.defaultLength||this.edgeLength;var c=d.length()-a;if(c>0.1){var b=this.springConstant*c;this.addForce(g,d,b);this.addForce(e,d,-1*b)}};TRIPTYCH.MP2LayoutEngine.prototype.updateNodePositions=function(){for(var b in this.graph.nodes){var c=this.graph.nodes[b];var a=c.force.length();var d=c.force.clone();d.z=0;if(a>this.maxForce){a=this.maxForce}d.normalize();d.multiplyScalar(a*this.damping);c.position.addSelf(d);c.position.z=0}};